import numpy as np
import matplotlib.pyplot as plt 
from netCDF4 import Dataset,netcdftime,num2date
import pandas as pd
import itertools
import csv
from osgeo import gdal, ogr, osr
from mpl_toolkits.mplot3d import Axes3D
import os
import rasterio
from scipy import stats
#%%
meanTemp_elevClass_sc = [-1.3406379273506024, -1.43943575077352, -1.5603945093981721, -1.6362125929455718, -1.7484101325795196, -1.8621972111040812, -1.9638927723939068, -2.070160066123058, -2.177201661316063, -2.2866207305736452]
meanTemp_elevClass_sc17a = [-1.3413686242480334, -1.441631243903555, -1.5547964521762065, -1.6388310407031346, -1.7510341530395905, -1.8649796460889612, -1.9631498179476006, -2.072749051434805, -2.179249778550018, -2.2981231251805747]
meanTemp_elevClass_sc24m = [-1.3410526743260212, -1.44102699968208, -1.5520818964896361, -1.6391751880095184, -1.7510888996911462, -1.8652954195974114, -1.9645036969392153, -2.0755221954945577, -2.1828178151693645, -2.2950156075515817]
meanTemp_elevClass_krew = [-3.895006213730667, -4.380816310085854, -4.759089975784103, -5.1684609385245555, -5.565482362647252, -5.9419489919372275, -6.421575851225449, -6.826060832837448, -7.227055557250234, -7.708640420269836]
meanTemp_elevClass_nrc = [-5.494272179223699, -5.87607877358175, -6.383703246404312, -6.878832799798176, -7.3724032807879025, -7.8846967823740925, -8.368559821245258, -8.811739619094885, -9.278484692643591, -9.702573704525387]
meanTemp_elevClass_jmz = [2.5769004528271977, 2.3621108180688406, 2.149433182989972, 1.9430838997722972, 1.7018546349253414, 1.478447694614881, 1.2709399632193996, 1.0538866045496587, 0.8047291973110248, 0.6072000155973027]

fsca_0u_sc26m = [0.3150031146832021, 0.24205359314742733, -0.20954167327912893, 0.12436217832142185, 0.03137703916047214, -0.04634426987739909, -0.029555902364116815, -0.05398835555407054, -0.025273580833120677, -0.009395200613040595]
fsca_0u_sc17a = [0.301267785449759, 0.26334332159979124, 0.2483170133447791, 0.6017868227398045, 0.3957026050380476, 0.12850484393977243, 0.019790781095728325, -0.046503870592969475, -0.040847442114481464, -0.02338565950569977]
fsca_0u_sc24m = [0.379898308755692, 0.13236051935137244, 0.2629839165140762, 0.48247569558516085, 0.9309524565727986, 1.0922939813767223, 0.8112276142423117, 0.7047611618621199, 0.32930949508852536, -0.40044501371395197]
fsca_0u_krew = [0.0872739399541158, 0.19770551501538824, 0.06426572893906199, 0.033483452565618216, 0.010520614796394634, 0.003932038422906912, -0.013275975518091435, -0.04033604717441615, -0.06116172071599474, -0.04206655810740767]
fsca_0u_nrc = [-1.2985575318179023, -0.5236461443311851, 0.085450861253903, 0.5652124259785979, -1.3392054923508023, -1.9068278530262612, -3.466560109399173, -1.1877607539284365, -1.405960715141119, 0.2744586321841476]
fsca_0u_jmz = [-2.0799608806544483, -2.1878617931979343, -3.071839475818581, -0.6868206888044819, 1.274816137918075, -0.9000222453838325, 1.2108189019224087, 1.189729069817121, 0.024158512223155758, 0.1346503769531198]

tempMean = [meanTemp_elevClass_sc,meanTemp_elevClass_sc17a,meanTemp_elevClass_sc24m,
            meanTemp_elevClass_krew,meanTemp_elevClass_nrc,meanTemp_elevClass_jmz]

fsca_0u = [fsca_0u_sc26m,fsca_0u_sc17a,fsca_0u_sc24m,
          fsca_0u_krew,fsca_0u_nrc,fsca_0u_jmz]
label = ['Sagehen Creek 26March2016','Sagehen Creek 17April2016','Sagehen Creek 24May2016','Krew 2010','NRC 2010','JMZ 2010']
color = ['blue','green','orange','red','navy','darkcyan']

plt.subplots(figsize=(30,20)) #fig, ax = plt.subplots(figsize=(20,15))
plt.title('(delta fSCA)/fSCA_op in different temp lapse rate', fontsize=35)
#for i in range (6):
#
#    plt.subplot(231+i)
#    plt.scatter(tempMean[i],fsca_0u[i], label = label[i], s=10**2, color = color[i])
#    plt.plot(tempMean[i],fsca_0u[i], color = color[i])
#
#    plt.ylabel('delta fSCA% [0pen-undercanopy]', fontsize=20)
#    plt.yticks(fontsize=10)
#    plt.xlabel('temp (C)', fontsize=20)
#    plt.xticks(fontsize=10)
#    plt.legend(fontsize=15, loc = 'lower right')
#
#plt.savefig('C:/1UNRuniversityFolder/Dissertation/Chapter 2-snow-forest/LiDarAnalysis/lapseRate_gridMet/temp_deltaFsca.png')

for i in range (6):

    plt.scatter(tempMean[i],fsca_0u[i], label = label[i], s=10**2.2, color = color[i])
    plt.plot(tempMean[i],fsca_0u[i], color = color[i])

plt.ylabel('(delta fSCA)/fSCA_op', fontsize=30)
plt.yticks(fontsize=30)
plt.xlabel('temp (C)', fontsize=30)
plt.xticks(fontsize=30)
plt.legend(fontsize=25, loc = 'lower center')

plt.savefig('C:/1UNRuniversityFolder/Dissertation/Chapter 2-snow-forest/LiDarAnalysis/lapseRate_gridMet/temp_deltaFsca4.png')






